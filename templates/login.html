<!DOCTYPE html>
<html lang="ru">

<head>
    <title>Smart House</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" href="/static/css/main.css" type="text/css" media="screen" charset="utf-8" />
    <link rel="shortcut icon" href="/static/img/favicon.png" type="image/png">
    <script type="text/javascript" src="/static/js/api.js"></script>
</head>

<body>
    <div class="limiter">
        <div class="container-login" style="background-image: url('/static/img/weather.gif');">
            <div class="wrap-login p-t-50 p-b-90">
                <form class="login-form validate-form flex-sb flex-w" id="login_form">
                    <span class="login-form-title p-b-51">
                        Welcome
                    </span>

                    <div class="wrap-input" data-validate="Username is required">
                        <input class="input" type="text" name="username" placeholder="Username">
                        <span class="focus-input"></span>
                    </div>


                    <div class="wrap-input" data-validate="Password is required">
                        <input class="input" type="password" name="password" placeholder="Password">
                        <span class="focus-input"></span>
                    </div>

                    <div class="wrap-label" data-validate="Password is required">
                        <label class="error-label" id="error"></label>
                    </div>


                    <div class="container-login-form-btn m-t-17">
                        <button class="login-form-btn">
                            Login
                        </button>
                    </div>

                </form>

                <script>
                    window.addEventListener("load", function () {
                        let form = document.getElementById("login_form");

                        form.addEventListener("submit", function (event) {
                            event.preventDefault();
                            var req = new XMLHttpRequest();
                            var creds = { "password": form.elements["password"].value, "username": form.elements["username"].value };
                            req.open("POST", "/api/v1/login");
                            req.onreadystatechange = function () {
                                if (req.status == 200) {
                                    window.location = "/";
                                } else {
                                    error = document.getElementById("error")
                                    error.innerHTML = "Credentials are wrong"
                                }
                            }
                            req.send(JSON.stringify(creds));
                        });
                    });
                </script>

            </div>
        </div>
    </div>
</body>

</html>